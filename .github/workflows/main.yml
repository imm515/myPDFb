name: Process PDF from Private Repo

on:
  workflow_dispatch:  # 使工作流支持手动触发

jobs:
  process-pdf:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout public repo
        uses: actions/checkout@v2

      - name: Checkout private repo
        uses: actions/checkout@v2
        with:
          repository: ${{ secrets.PRIVATE_REPO }}
          token: ${{ secrets.PAT }}
          path: private-repo
          ref: main  # 如果你的私库默认分支是 `main`，否则改成 `master`

      - name: List PDF files in private repo
        run: |
          find private-repo/${{ secrets.PRIVATE_DIR }} -name "*.pdf" > pdf_files.txt
          cat pdf_files.txt

      - name: Debug repository setup
        run: |
          git remote -v
          git branch -a

      - name: Process PDF files and show filenames in log
        run: |
          while read file; do
            filename=$(basename "$file")
            # Show first and last 5 characters, hide middle part
            short_filename="${filename:0:3}...${filename: -8}"
            echo "Processing file: $short_filename"
            # Your PDF processing code here
          done < pdf_files.txt
